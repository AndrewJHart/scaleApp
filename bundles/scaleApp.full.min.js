(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J={}.hasOwnProperty,K=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};e=function(a){var b,c,d;if(a instanceof Array)b=function(){var b,c,e;e=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.push(d);return e}();else{b={};for(c in a)d=a[c],b[c]=d}return b},String.prototype.trim==null&&(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}),k=function(a){var b,c,d,e,f;a==null&&(a=function(){}),c=a.toString().match(/function[^(]*\(([^)]*)\)/);if(c==null||c.length<2)return[];c=c[1],c=c.split(/\s*,\s*/),f=[];for(d=0,e=c.length;d<e;d++)b=c[d],b.trim()!==""&&f.push(b);return f},E=function(a){var b;a==null&&(a=8),b="";while(b.length<a)b+=Math.random().toString(36).substr(2);return b.substr(0,a)},x=function(a,b){var c,d,e,f,g,h,i,j,k;a==null&&(a=[]),b==null&&(b=function(){}),d=a.length,g=[];if(d===0)return typeof b=="function"?b(null,g):void 0;e=[],c=function(){var a;d--;if(d===0)return function(){var b,c,d;d=[];for(b=0,c=e.length;b<c;b++)a=e[b],a!=null&&d.push(a);return d}().length>0?b(e,g):b(null,g)},k=[];for(f=i=0,j=a.length;i<j;f=++i)h=a[f],k.push(function(a,b){var d;d=function(a,d){return a!=null?(e[b]=a,g[b]=void 0):g[b]=d,c()};try{return a(d)}catch(f){return d(f)}}(h,f));return k},i=function(a,b,c){var d,e;return a==null&&(a=[]),e=function(){var c,e,f;f=[];for(c=0,e=a.length;c<e;c++)d=a[c],f.push(function(a){return function(c){return b(a,c)}}(d));return f}(),H.runSeries(e,c)},H={doForAll:i,runSeries:x,clone:e,getArgumentNames:k,uniqueId:E},(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=H),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&typeof require=="function"&&(H=require("./Util")),a=function(){function a(a,b){this.cascadeChannels=b!=null?b:!1,this.channels={},a&&this.installTo(a)}return a.prototype.subscribe=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o;d==null&&(d=this),(m=(j=this.channels)[b])==null&&(j[b]=[]),h=this;if(b instanceof Array){n=[];for(k=0,l=b.length;k<l;k++)e=b[k],n.push(this.subscribe(e,c,d));return n}if(typeof b=="object"){o=[];for(f in b)i=b[f],o.push(this.subscribe(f,i,c));return o}return typeof c!="function"?!1:typeof b!="string"?!1:(g={context:d,callback:c},{attach:function(){return h.channels[b].push(g),this},detach:function(){return a._rm(h,b,g.callback),this}}.attach())},a.prototype.on=a.prototype.subscribe,a.prototype.unsubscribe=function(b,c){var d;switch(typeof b){case"string":typeof c=="function"&&a._rm(this,b,c),typeof c=="undefined"&&a._rm(this,b);break;case"function":for(d in this.channels)a._rm(this,d,b);break;case"undefined":for(d in this.channels)a._rm(this,d);break;case"object":for(d in this.channels)a._rm(this,d,null,b)}return this},a.prototype.publish=function(a,b,c){var d,e,f,g,h;return c==null&&(c={}),typeof b=="function"&&(c=b,b=void 0),typeof a!="string"?!1:(g=this.channels[a]||[],b!=null&&c.publishReference!==!0&&typeof b=="object"&&(e=H.clone(b)),h=function(){var c,d,h;h=[];for(c=0,d=g.length;c<d;c++)f=g[c],h.push(function(c){return function(d){try{return H.getArgumentNames(c.callback).length>=3?c.callback.apply(c.context,[e||b,a,d]):d(null,c.callback.apply(c.context,[e||b,a]))}catch(f){return d(f)}}}(f));return h}(),H.runSeries(h,function(a,b){var d,e;return(a!=null?a.length:void 0)>0&&(d=new Error(function(){var b,c,d;d=[];for(b=0,c=a.length;b<c;b++)e=a[b],e!=null&&d.push(e.message);return d}().join("; "))),typeof c=="function"?c(d):void 0}),this.cascadeChannels&&(d=a.split("/")).length>1&&this.publish(d.slice(0,-1).join("/"),b,c),this)},a.prototype.emit=a.prototype.publish,a.prototype.installTo=function(a){var b,c;if(typeof a=="object")for(b in this)c=this[b],a[b]=c;return this},a._rm=function(a,b,c,d){var e;return a.channels[b]=function(){var f,g,h,i;h=a.channels[b],i=[];for(f=0,g=h.length;f<g;f++)e=h[f],(c!=null?e.callback!==c:d!=null?e.context!==d:e.context!==a)&&i.push(e);return i}()},a}(),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=a),b=function(){function a(a,b,c){this.core=a,this.instanceId=b,this.options=c!=null?c:{};if(this.core==null)throw new TypeError("core was not defined");if(b==null)throw new TypeError("no id was specified");if(typeof b!="string")throw new TypeError("id is not a string")}return a}(),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=b),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&typeof require=="function"&&require.amd==null&&(a=require("./Mediator"),b=require("./Sandbox"),H=require("./Util")),c="0.3.8",r={},n={},m={},q=new a,u={},j=function(a){return typeof console!="undefined"&&console!==null?typeof console.error=="function"?console.error(a.message):void 0:void 0},t={_always:[]},s=function(a,b){var c;if(typeof a!="function")throw new Error("expect a function as parameter");c={context:this,callback:a};if(typeof b=="string")return t[b]==null&&(t[b]=[]),t[b].push(c);if(b==null)return t._always.push(c)},l=function(a,b,c){var d,e,f,g,h;f={},h=b.options;for(e in h)g=h[e],f[e]=g;d=m[a];if(d)for(e in d)g=d[e],f[e]=g;if(c)for(e in c)g=c[e],f[e]=g;return f},h=function(a,c,d){var e,g,h,i,j,k,m,o,p,s,v,w,x,y,z,A,B;c==null&&(c=a),k=r[a];if(n[c]!=null)return n[c];h=l(c,k,d),s=new b(f,c,h),q.installTo(s);for(g in u){o=u[g];if(o.sandbox==null)continue;p=new o.sandbox(s);for(j in p){if(!J.call(p,j))continue;v=p[j],s[j]=v}}i=new k.creator(s),i.options=h,i.id=c,n[c]=i,A=[c,"_always"];for(w=0,y=A.length;w<y;w++){m=A[w];if(t[m]!=null){B=t[m];for(x=0,z=B.length;x<z;x++)e=B[x],e.callback.apply(e.context)}}return i},d=function(a,b,c){var d;if(typeof a!="string")throw new TypeError("module ID has to be a string");if(typeof b!="function")throw new TypeError("creator has to be a constructor function");if(typeof c!="object")throw new TypeError("option parameter has to be an object");d=new b;if(typeof d!="object")throw new TypeError("creator has to return an object");if(typeof d.init!="function")throw new TypeError("module has to have an init function");if(typeof d.destroy!="function")throw new TypeError("module has to have a destroy function");if(r[a]!=null)throw new TypeError("module "+a+" was already registered");return r[a]={creator:b,options:c,id:a},!0},v=function(a,b,c){c==null&&(c={});try{return d(a,b,c)}catch(e){return j(new Error("could not register module '"+a+"': "+e.message)),!1}},z=function(a,b){var c,d,e,f;if(typeof a!="string")throw new TypeError("instance ID has to be a string");if(typeof b!="object")throw new TypeError("option parameter has to be an object");(e=m[a])==null&&(m[a]={}),f=[];for(c in b)d=b[c],f.push(m[a][c]=d);return f},F=function(a){return r[a]!=null?(delete r[a],!0):!1},G=function(){var a,b;b=[];for(a in r)b.push(F(a));return b},A=function(a,b){var c;b==null&&(b={});try{if(typeof a!="string")throw new Error("module ID has to be a string");if(typeof b!="object")throw new Error("second parameter has to be an object");if(r[a]==null)throw new Error("module does not exist");c=h(a,b.instanceId,b.options);if(c.running===!0)throw new Error("module was already started");return H.getArgumentNames(c.init).length>=2?c.init(c.options,function(a){return typeof b.callback=="function"?b.callback(a):void 0}):(c.init(c.options),typeof b.callback=="function"&&b.callback(null)),c.running=!0,!0}catch(d){return j(d),typeof b.callback=="function"&&b.callback(new Error("could not start module: "+d.message)),!1}},C=function(a,b){var c;return(c=n[a])?(q.unsubscribe(c),H.getArgumentNames(c.destroy).length>=1?c.destroy(function(a){return typeof b=="function"?b(a):void 0}):(c.destroy(),typeof b=="function"&&b(null)),delete n[a],!0):!1},B=function(a,b){var c,d,e,f,g,h,i;return a instanceof Array?(f=a,a=b,b=null,h=function(){var a,b,d;d=[];for(a=0,b=f.length;a<b;a++)c=f[a],r[c]!=null&&d.push(c);return d}()):f=h=function(){var a;a=[];for(c in r)a.push(c);return a}(),h.length===(i=f.length)&&i===0?(typeof a=="function"&&a(null),!0):(h.length!==f.length&&(d=function(){var a,b,d;d=[];for(a=0,b=f.length;a<b;a++)c=f[a],K.call(h,c)>=0||d.push("'"+c+"'");return d}(),e=new Error("these modules don't exist: "+d)),g=function(a,b){var c,d,e,f;e={},d=r[a].options;for(c in d){if(!J.call(d,c))continue;f=d[c],f&&(e[c]=f)}return e.callback=function(a){return typeof d.callback=="function"&&d.callback(a),b(a)},A(a,e)},H.doForAll(h,g,function(b){var c,d,f;return(b!=null?b.length:void 0)>0&&(c=new Error("errors occoured in the following modules: "+function(){var a,c,e;e=[];for(d=a=0,c=b.length;a<c;d=++a)f=b[d],f!=null&&e.push("'"+h[d]+"'");return e}())),typeof a=="function"?a(c||e):void 0}),e==null)},D=function(a){var b;return H.doForAll(function(){var a;a=[];for(b in n)a.push(b);return a}(),C,a)},y=["core","instanceId","options","publish","emit","on","subscribe","unsubscribe"],p=function(a){var b,c,d;d=[];for(b in a)c=a[b],d.push(b);return d},w=function(a){var c,d,e,h;try{if(typeof a!="object")throw new Error("plugin has to be an object");if(typeof a.id!="string")throw new Error("plugin has no id");if(typeof a.sandbox=="function"){for(c in new a.sandbox(new b(f,"")))if(K.call(y,c)>=0)throw new Error("plugin uses reserved keyword");e=a.sandbox.prototype;for(c in e)d=e[c],b.prototype[c]=d}if(typeof a.core=="object"){for(c in a.core)if(K.call(g,c)>=0)throw new Error("plugin uses reserved keyword");h=a.core;for(c in h)d=h[c],f[c]=d,typeof exports!="undefined"&&exports!==null&&(exports[c]=d)}return typeof a.onInstantiate=="function"&&s(a.onInstantiate),u[a.id]=a,!0}catch(i){return j(i),!1}},f={VERSION:c,register:v,unregister:F,unregisterAll:G,registerPlugin:w,setInstanceOptions:z,start:A,stop:C,startAll:B,stopAll:D,uniqueId:H.uniqueId,lsInstances:function(){return p(n)},lsModules:function(){return p(r)},lsPlugins:function(){return p(u)},util:H,Mediator:a,Sandbox:b,subscribe:function(){return q.subscribe.apply(q,arguments)},on:function(){return q.subscribe.apply(q,arguments)},unsubscribe:function(){return q.unsubscribe.apply(q,arguments)},publish:function(){return q.publish.apply(q,arguments)},emit:function(){return q.publish.apply(q,arguments)}},g=function(){var a;a=[];for(o in f)I=f[o],a.push(o);return a}(),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=f),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null?(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return f}):typeof window!="undefined"&&window!==null&&(window.scaleApp=f)}).call(this),function(){var a,b,c,d,e,f,g,h,i,j;a=(typeof window!="undefined"&&window!==null?(j=window.scaleApp)!=null?j.Mediator:void 0:void 0)||(typeof require=="function"?require("../Mediator"):void 0),f={},c=function(a,b,c){var d,e,g,h,i,j,k;if(c!=null){g=(j=f[a])!=null?j:f[a]={},d=(k=g[b])!=null?k:g[b]={},typeof c=="string"&&(c=[c]);for(h=0,i=c.length;h<i;h++)e=c[h],d[e]=!0;return!0}return!1},h=function(a,b,c){var d,e;return d=f[a],c==null?(delete d[b],!0):(d!=null?(e=d[b])!=null?e[c]:void 0:void 0)?(delete d[b][c],!0):!1},e=function(a,b,c){var d,e;return c!=null&&((d=f[a])!=null?(e=d[b])!=null?e[c]:void 0:void 0)?!0:(console.warn("'"+a+"' has no permissions for '"+b+"' with '"+c+"'"),!1)},d=function(a,b,c,d){var f,g;return(d!=null?d.length:void 0)>0&&(f=d[0]),g=e(a.instanceId,b,f),g===!0?c.apply(a,d):!1},i=function(a,b){var c;c=a[b];if(typeof c=="function")return a[b]=function(){return d(a,b,c,arguments)}},b=function(){function a(a){i(a,"subscribe"),i(a,"publish"),i(a,"unsubscribe")}return a}(),g={id:"permission",sandbox:b,core:{permission:{add:c,remove:h}}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&window.scaleApp.registerPlugin(g),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=g),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return g})}.call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a){this.sb=a,this.getContainer=c(this.getContainer,this)}return a.prototype.getContainer=function(){switch(typeof this.sb.options.container){case"string":return document.getElementById(this.sb.options.container);case"object":return this.sb.options.container;default:return document.getElementById(this.sb.instanceId)}},a}(),b={id:"dom",sandbox:a},window.scaleApp!=null&&window.scaleApp.registerPlugin(b),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=b),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return b})}.call(this),function(){var a,b,c,d,e,f={}.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};e=(typeof window!="undefined"&&window!==null?window.scaleApp:void 0)||(typeof require=="function"?require("../scaleApp"):void 0),b=function(a){function b(a){var c,d;b.__super__.constructor.call(this),this.id=(a!=null?a.id:void 0)||e.uniqueId();for(c in a)d=a[c],this[c]==null&&(this[c]=d)}return g(b,a),b.prototype.set=function(a,c,d){var e,f;d==null&&(d=!1);switch(typeof a){case"object":for(e in a)f=a[e],this.set(e,f,!0);d||this.publish(b.CHANGED,function(){var b;b=[];for(e in a)f=a[e],b.push(e);return b}());break;case"string":a!=="set"&&a!=="get"&&this[a]!==c&&(this[a]=c,d||this.publish(b.CHANGED,[a]));break;default:typeof console!="undefined"&&console!==null&&typeof console.error=="function"&&console.error("key is not a string")}return this},b.prototype.change=function(a,c){if(typeof a=="function")return this.subscribe(b.CHANGED,a,c);if(arguments.length===0)return this.publish(b.CHANGED)},b.prototype.notify=function(){return this.change()},b.prototype.get=function(a){return this[a]},b.prototype.toJSON=function(){var a,b,c;a={};for(b in this){if(!f.call(this,b))continue;c=this[b],a[b]=c}return a},b.CHANGED="changed",b}(e.Mediator),c=function(){function a(a){a&&this.setModel(a)}return a.prototype.setModel=function(a){return this.model=a,this.model.change(function(){return this.render()},this)},a.prototype.render=function(){},a}(),a=function(){function a(a,b){this.model=a,this.view=b}return a}(),d={id:"mvc",core:{Model:b,View:c,Controller:a}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&e.registerPlugin(d),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=d),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return d})}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(typeof window=="undefined"||window===null)throw new Error("This plugin only can be used in the browser");x=window.scaleApp,d="xmpp",b="http-bind/",c=5280,a="scaleApp."+d+".cache.",h=null,i={host:document.domain,port:c,path:b,jid:null,sid:null,rid:null},l=function(a){var c;c=document.domain;if(typeof a=="object"){a.port&&(a.port=a.port*1,isNaN(a.port)&&(console.warn("the defined port "+a.port+" is not a number."),a.port=null));if(a.host&&a.port&&a.path)return"http://"+a.host+":"+a.port+"/"+a.path;if(a.host&&a.port&&!a.path)return"http://"+a.host+":"+a.port+"/"+b;if(a.host&&!a.port&&a.path)return"http://"+a.host+"/"+a.path;if(a.host&&!a.port&&!a.path)return"http://"+a.host+"/"+b;if(!a.host&&a.port&&a.path)return"http://"+c+":"+a.port+"/"+a.path;if(!a.host&&a.port&&!a.path)return"http://"+c+":"+a.port+"/"+b;if(!a.host&&!a.port&&a.path)return"http://"+c+"/"+a.path;if(!a.host&&!a.port&&!a.path)return"http://"+c+"/"+b}return"http://"+c+"/"+b},j=function(){return new Strophe.Connection(l({path:i.path,host:i.host,port:i.port}))},p=function(b){return""+a+b},f=function(b){return b.split(a)[1]},w=function(){var a,b,c,d,e,f,g,j;if(typeof localStorage!="undefined"&&localStorage!==null){f=["jid","sid","rid"];for(b=0,d=f.length;b<d;b++)a=f[b],h[a]!=null&&(localStorage[p(a)]=h[a]);g=["host","port","path"],j=[];for(c=0,e=g.length;c<e;c++)a=g[c],i[a]!=null&&j.push(localStorage[p(a)]=i[a]);return j}},g=function(){return typeof localStorage!="undefined"&&localStorage!==null?localStorage.clear():void 0},r=function(){var a,b,c,d,e,f,i,j,k;b=function(a){if(a.keyCode===27)return typeof a.preventDefault=="function"?a.preventDefault():void 0},c=function(){return h?w():g()};if(document.addEventListener!=null){j=["keydown","keypress","keyup"];for(d=0,f=j.length;d<f;d++)a=j[d],document.addEventListener(a,b,!1);window.addEventListener("unload",c,!1)}else if(document.attachEvent!=null){k=["onkeydown","onkeypress","onkeyup"];for(e=0,i=k.length;e<i;e++)a=k[e],document.attachEvent(a,b);document.attachEvent("onunload",c)}return h.send($pres())},y=function(a){switch(a){case 0:return"Error";case 1:return"Connecting";case 2:return"Connection failed";case 3:return"Authenticating";case 4:return"Authentication failed";case 5:return"Connected";case 6:return"Disconnected";case 7:return"Disconnecting";case 8:return"Reconnected"}},s=function(a){var b;console.info("xmpp status changed: "+y(a)),b=Strophe.Status;switch(a){case b.ERROR:return u(),x.publish(""+d+"/error","an error occoured");case b.CONNECTING:return u(),x.publish(""+d+"/connecting");case b.CONFAIL:return u(),x.publish(""+d+"/error","could not connect to xmpp server");case b.AUTHENTICATING:return u(),x.publish(""+d+"/authenticating");case b.AUTHFAIL:return u(),x.publish(""+d+"/authfail");case b.CONNECTED:return z(h),r(),x.publish(""+d+"/connected");case b.DISCONNECTED:return g(),u(),x.publish(""+d+"/disconnected");case b.DISCONNECTING:return u(),x.publish(""+d+"/disconnecting");case b.ATTACHED:return z(h),r(),x.publish(""+d+"/attached")}},u=function(){return A.connection=null,A.jid=""},z=function(a){return A.connection=a,A.jid=a.jid},e=function(a){return h=j(),i.jid=Strophe.getBareJidFromJid(i.jid),h.attach(i.jid,i.sid,i.rid,s,60)},q=function(a,b,c){return c!=null&&(c.path&&(i.path=c.path),c.port&&(i.port=c.port),c.host&&(i.host=c.host)),h=j(),h.connect(a,b,s)},k=function(){return console.debug("try to disconnect"),h!==null&&(h.send($pres({type:"unavailable"})),h.pause(),h.disconnect()),g()},o=function(a){return Strophe.getBareJidFromJid(a).replace("@","-").replace(".","-").replace(".","-")},v=function(){var a,b,c,d,e,g;if(typeof localStorage!="undefined"&&localStorage!==null){e=["jid","sid","rid","host","port","path"],g=[];for(c=0,d=e.length;c<d;c++)b=e[c],a=f(b),localStorage[a]?g.push(i[b]=localStorage[a]):g.push(void 0);return g}},m=function(){var a,b,c,d,e;b=i,e=["jid","sid","rid"];for(c=0,d=e.length;c<d;c++){a=e[c];if(!b[a]||b[a]==="null"||b[a]==="undefined")return!1}return!0},n=function(){if(typeof Strophe=="undefined"||Strophe===null)throw new Error("This plugin requires strophe.js");return v(),m()?e():x.publish(""+d+"/disconnected")},A={init:n,jid:"",connection:null,login:q,logout:k},t={id:d,core:{xmpp:A}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&x.registerPlugin(t),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=t),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return t})}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=[].slice;a=(typeof window!="undefined"&&window!==null?(q=window.scaleApp)!=null?q.Mediator:void 0:void 0)||(typeof require=="function"?require("../Mediator"):void 0),c="en",f=function(){return((typeof navigator!="undefined"&&navigator!==null?navigator.language:void 0)||(typeof navigator!="undefined"&&navigator!==null?navigator.browserLanguage:void 0)||c).split("-")[0]},j=f(),k=new a,d="i18n",i={},o=function(){return k.subscribe.apply(k,[d].concat(r.call(arguments)))},p=function(){return k.unsubscribe.apply(k,[d].concat(r.call(arguments)))},g=function(){return j},n=function(a){if(typeof a=="string")return j=a,k.publish(d,j)},m=function(a){return typeof a=="object"?(i=a,!0):!1},h=function(a,b,c){var d,e;return((d=b[c])!=null?d[a]:void 0)||((e=i[c])!=null?e[a]:void 0)},e=function(a,b){return b==null&&(b={}),h(a,b,j)||h(a,b,j.substring(0,2))||h(a,b,c)||a},b=function(){function a(a){this.sb=a}return a.prototype.i18n={subscribe:o,on:o,unsubscribe:p},a.prototype._=function(a){return e(a,this.sb.options.i18n)},a.prototype.getLanguage=g,a}(),l={id:"i18n",sandbox:b,core:{i18n:{setLanguage:n,getBrowserLanguage:f,getLanguage:g,baseLanguage:c,get:e,subscribe:o,on:o,unsubscribe:p,setGlobal:m}}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&typeof window!="undefined"&&window!==null&&window.scaleApp.registerPlugin(l),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=l),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return l})}.call(this),function(){var a,b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}},g={}.hasOwnProperty,h=function(a,b){function d(){this.constructor=a}for(var c in b)g.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},i=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};e=(typeof window!="undefined"&&window!==null?window.scaleApp:void 0)||(typeof require=="function"?require("../scaleApp"):void 0),c=function(a){return""+a+"/leave"},b=function(a){return""+a+"/enter"},a=function(a){function d(a){var c,e,g;a==null&&(a={}),this.fire=f(this.fire,this),d.__super__.constructor.call(this),this.states=[],this.transitions={},a.states!=null&&this.addState(a.states),a.start!=null&&(this.addState(a.start),this.start=a.start,this.current=a.start,this.emit(b(this.start)));if(a.transitions!=null){g=a.transitions;for(c in g)e=g[c],this.addTransition(c,e)}}return h(d,a),d.prototype.start=null,d.prototype.current=null,d.prototype.exit=null,d.prototype.addState=function(a,d){var e,f,g,h;return d==null&&(d={}),a instanceof Array?!(i.call(function(){var b,c,d;d=[];for(b=0,c=a.length;b<c;b++)f=a[b],d.push(this.addState(f));return d}.call(this),!1)>=0):typeof a=="object"?!(i.call(function(){var b;b=[];for(e in a)h=a[e],b.push(this.addState(e,h));return b}.call(this),!1)>=0):typeof a!="string"?!1:i.call(this.states,a)>=0?!1:(this.states.push(a),g=[],d.enter!=null&&g.push(this.on(b(a),d.enter)),d.leave!=null&&g.push(this.on(c(a),d.leave)),!(i.call(g,!1)>=0))},d.prototype.addTransition=function(a,b){var c,d,e;if(typeof a=="string"&&typeof b.to=="string"&&this.transitions[a]==null&&(e=b.to,i.call(this.states,e)>=0)){if(b.from instanceof Array){c=i.call(function(){var a,c,e,f;e=b.from,f=[];for(a=0,c=e.length;a<c;a++)d=e[a],f.push(i.call(this.states,d)>=0);return f}.call(this),!1)>=0;if(c!==!1)return!1}else if(typeof b.from!="string")return!1;return this.transitions[a]={from:b.from,to:b.to},!0}return!1},d.prototype.onEnter=function(a,c){var d;return(d=!a,i.call(this.states,d)>=0)?!1:this.on(b(a),c)},d.prototype.onLeave=function(a,b){var d;return(d=!a,i.call(this.states,d)>=0)?!1:this.on(c(a),b)},d.prototype.fire=function(a,d){var e,f=this;return d==null&&(d=function(){}),e=this.transitions[a],e==null||!this.can(a)?!1:(this.emit(c(this.current),e,function(a){return a!=null?d(a):f.emit(b(e.to),e,function(a){return a==null&&(f.current=e.to),d(a)})}),!0)},d.prototype.can=function(a){var b,c;return b=this.transitions[a],(b!=null?b.from:void 0)===this.current||(c=this.current,i.call(b.from,c)>=0)||b.from==="*"},d}(e.Mediator),d={id:"state",core:{StateMachine:a}},(typeof window!=="undefined"&&window!==null?window.scaleApp:void 0)!=null&&e.registerPlugin(d),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=d),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return d})}.call(this),function(){var a,b,c;b=function(a,b,c){var d,e,f,g;if(c===!0){f=[];for(d in a)e=a[d],f.push(b[d]=e);return f}g=[];for(d in a)e=a[d],b.hasOwnProperty(d)||g.push(b[d]=e);return g},a=function(){function a(a){}return a.prototype.countObjectKeys=function(a){var b,c;if(typeof a=="object")return function(){var d;d=[];for(b in a)c=a[b],d.push(b);return d}().length},a.prototype.mixin=function(a,c,d){d==null&&(d=!1);switch(""+typeof c+"-"+typeof a){case"function-function":return b(c.prototype,a.prototype,d);case"function-object":return b(c.prototype,a,d);case"object-object":return b(c,a,d);case"object-function":return b(c,a.prototype,d)}},a}(),c={id:"util",sandbox:a},typeof scaleApp!="undefined"&&scaleApp!==null&&scaleApp.registerPlugin(c),(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null&&(module.exports=c),(typeof define!=="undefined"&&define!==null?define.amd:void 0)!=null&&define(function(){return c})}.call(this);