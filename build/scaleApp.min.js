(function(i,c){function d(f){var a=k[f];if(a)a.destroy(),delete k[f],$.each(t[f],function(f,a){a&&d(a)});else return g("could not stop instance '"+f+"' - instance does not exist.",c),!1}function e(f,n,b,h){return typeof f==="string"&&(typeof n==="string"&&!b||typeof n==="object"&&!b||typeof n==="string"&&typeof b==="object"||!n&&!b)||$.isArray(f)&&!n&&!b?a(f,n,b,h):(g("could not start module '"+f+"' - illegal arguments.",c),!1)}function a(f,a,h,g){var e=b(f,a,h);if(e)return o("start '"+e.moduleId+
"'",c,"debug"),p(e.moduleId,e.instanceId,e.opt,function(f){k[e.instanceId]=f;f.init(f.opt);typeof g==="function"&&g()}),!0;return!1}function b(f,a,c){typeof a==="object"&&!c&&(c=a,a=f);!a&&!c&&(a=f,c={});return{moduleId:f,instanceId:a,opt:c}}function h(f,a,b){if(typeof f!=="string")return g("could not register module- mouduleId has to be a string",c),!1;if(typeof a!=="function")return g("could not register module - creator has to be a constructor function",c),!1;f=a();if(typeof f!=="object"||typeof f.init!==
"function"||typeof f.destroy!=="function")return g("could not register module - creator has to return an object with the functions 'init' and 'destroy'",c),!1;if(b&&!j(b))return!1;return!0}function j(f){if(typeof f!=="object")return g("could not register module - option has to be an object",c),!1;if(f.views&&typeof f.views!=="object")return!1;if(f.models&&typeof f.models!=="object")return!1;return!0}function q(f,a,c,b){function h(f){$.each(f,function(f,h){e.push(h(a,c,b))})}var g=$.Deferred(),e=[];
h(l._always);l[f]&&h(l[f]);$.when.apply(null,e).done(function(){g.resolve()});return g.promise()}function p(f,a,b,h){var g=r[f],e;if(g){var d={};$.extend(!0,d,g.opt,b);var j=new m.sandbox(a,d);$.each(s,function(f,c){var b=new c(j,a);$.extend(!0,j,b)});e=g.creator(j);e.opt=d;q(f,a,d,j).done(function(){typeof h==="function"?h(e):o(" callback function is not a function",c,"warn")}).fail(function(){})}else(void 0)("could not start module '"+f+"' - module does not exist.",c)}function g(f,a){o(f,a,"error")}
function o(a,c,b){if(m.log&&typeof m.log[b]==="function")m.log[b](a,c)}var m=this,r={},k={},t={},s={},l={_always:[]},m={register:function(a,c,b){if(!h(a,c,b))return!1;b||(b={});r[a]={creator:c,opt:b};return!0},onInstantiate:function(a,b){typeof a==="function"?b&&typeof b==="string"?(l[b]||(l[b]=[]),l[b].push(a)):l._always.push(a):g("onInstantiate expect a function as parameter",c)},addPlugin:function(a,b){typeof a==="string"&&typeof b==="function"?s[a]=s[a]||b:g("addPluggin expect an id and a function as parameters",
c)},start:e,startSubModule:function(a,c,h,g,d){a=b(a,c,h);e(a.moduleId,a.instanceId,a.opt,d)&&typeof g==="string"&&((g=t[g])||(g=[]),g.push(a.instanceId))},stop:d,startAll:function(a,b){function h(){}if(typeof a==="function")var d=0,d=$.isArray(b)?b.length:m.util.countObjectKeys(r),h=function(){d--;d===0&&a()};$.isArray(b)?$.each(b,function(a,b){typeof b==="string"?e(b,b,r[b].opt,h):typeof b==="object"?b.j&&b.k?e(b.j,b.m,b.k,h):g("Could not start module from array - invalid parameters",c):g("Could not start module from array",
c)}):$.each(r,function(a,b){b&&e(a,a,b.opt,h)})},stopAll:function(){$.each(k,function(a){d(a)})},publish:function(a,b,c){$.each(k,function(h,g){if(g.subscriptions){var e=g.subscriptions[a];e&&$.each(e,function(h,g){if(typeof g==="function")if(typeof b==="object"&&c!==!0){var e={};$.extend(!0,e,b);g(e,a)}else g(b,a)})}})},subscribe:function(a,b,c){o("subscribe to '"+b+"'",a,"debug");a=k[a];a.subscriptions||(a.subscriptions={});a=a.subscriptions;a[b]||(a[b]=[]);a[b].push(c)},getContainer:function(a){var b=
k[a].opt;if(b&&typeof b.container==="string")return $("#"+b.container);return $("#"+a)},getInstance:function(a){return k[a]},log:o};i[c]=i[c]||m})(window,"scaleApp");(function(i,c,d){function e(h,d,i){if(i)if(typeof d==="object"){e(h,i+":");e(h,d);return}else d=i+": "+d;switch(h){case b.d:a<=b.d&&c.debug(d);break;case b.c:a<=b.c&&c.info(d);break;case b.g:a<=b.g&&c.warn(d);break;case b.f:a<=b.f&&c.error(d);break;case b.e:a<=b.e&&c.error(d);break;default:c.log(d)}}c||(i=function(){},c={log:i,debug:i,info:i,warn:i,error:i,fatal:i});var a=0,b={d:0,c:1,g:2,f:3,e:4};d.log={debug:function(a,c){e(b.d,a,c)},info:function(a,c){e(b.c,a,c)},warn:function(a,c){e(b.g,a,c)},
error:function(a,c){e(b.f,a,c)},fatal:function(a,c){e(b.e,a,c)},setLogLevel:function(c){if(typeof c==="string")switch(c.toLowerCase()){case "debug":a=b.d;break;case "info":a=b.c;break;case "warn":a=b.g;break;case "error":a=b.f;break;case "fatal":a=b.e;break;default:a=b.c}else typeof c==="number"&&(a=c>=b.d&&c<=b.e?c:b.c)},getLogLevel:function(){return a}}})(window,window.console,window.scaleApp);(function(i,c){function d(){return(navigator.language||navigator.l||"en").split("-")[0]}var e=d();c.i18n=c.i18n||{setLanguage:function(a){if(typeof a==="string")return e=a,c.publish("languageChanged",a),!0;return!1},getBrowserLanguage:d,getLanguage:function(){return e},_:function(a,b){var d=c.getInstance(a);if(d.opt&&d.opt.i18n)if(d=d.opt.i18n,d[e]&&d[e][b])return d[e][b];else{var j=e.substring(0,2);if(d[j]&&d[j][b])return d[j][b];else if(d.en&&d.en[b])return d.en[b]}return b}}})(window,window.scaleApp);(function(i,c){c.util=c.util||{mixin:function(c,e){function a(a,c){var d={};$.extend(d,a,c);$.extend(c,d)}switch(typeof e+"-"+typeof c){case "function-function":a(e.prototype,c.prototype);break;case "function-object":a(e.prototype,c);break;case "object-object":a(e,c);break;case "object-function":a(e,c.prototype)}},countObjectKeys:function(c){var e=0;if(typeof c==="object")for(var a in c)e++;return e}}})(window,window.scaleApp);(function(i,c){function d(a,b,d){if(a=a[b]){if(!d&&c.util.countObjectKeys(a)===1){for(var e in a)break;return a[e]}return a[d]}}function e(a,b,c,d){a[b]||(a[b]={});a[b][c]=d}function a(a,b,c){typeof c==="object"&&$.each(c,function(c,d){d&&e(a,b,c,d)})}function b(a){typeof a==="object"&&$.each(a,function(a,b){b&&c.util.mixin(b,h)})}function h(){}h.prototype={subscribe:function(a){if(!this.b)this.b=[];this.b.push(a)},unsubscribe:function(a){if(this.b)this.b=this.b.filter(function(b){if(b!==a)return b})},
notify:function(){this.b&&$.each(this.b,function(a,b){typeof b.update==="function"&&b.update()})}};var j={},q={},p={};c.onInstantiate(function(c,d){d.models&&(b(d.models),a(j,c,d.models));d.views&&a(q,c,d.views);d.controllers&&a(p,c,d.controllers)});c.a=c.a||{addModel:function(a,b,c){e(j,a,b,c)},addView:function(a,b,c){e(q,a,b,c)},addController:function(a,b,c){e(p,a,b,c)},getModel:function(a,b){return d(j,a,b)},getView:function(a,b){return d(q,a,b)},getController:function(a,b){return d(p,a,b)},observable:h}})(window,
window.scaleApp);(function(i,c){c.sandbox=c.sandbox||function(d){var e={h:function(a){c.log.debug(a,d)},info:function(a){c.log.info(a,d)},warn:function(a){c.log.warn(a,d)},error:function(a){c.log.error(a,d)},i:function(a){c.log.fatal(a,d)}};return{subscribe:function(a,b){c.subscribe(d,a,b)},unsubscribe:function(a){c.unsubscribe(d,a)},publish:function(a,b,d){c.publish(a,b,d)},startSubModule:function(a,b,e,i){c.startSubModule(a,b,e,d,i)},stopSubModule:function(a){c.stop(a)},getModel:function(a){return c.a.getModel(d,
a)},getView:function(a){return c.a.getView(d,a)},getController:function(a){return c.a.getController(d,a)},addModel:function(a,b){return c.a.addModel(d,a,b)},addView:function(a,b){return c.a.addView(d,a,b)},addController:function(a,b){return c.a.addController(d,a,b)},observable:c.a.observable,getContainer:function(){return c.getContainer(d)},debug:e.h,info:e.info,warn:e.warn,error:e.error,fatal:e.i,mixin:c.util.mixin,count:c.util.countObjectKeys,_:function(a){return c.i18n._(d,a)},getLanguage:c.i18n.getLanguage}}})(window,
window.scaleApp);
