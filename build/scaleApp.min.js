/* scaleApp.js */
var scaleApp=function(){var q=function(e,g){var i=function(d,h){e.publish(d,h)},j={debug:function(d){e.log.debug(d,g)},info:function(d){e.log.info(d,g)},warn:function(d){e.log.warn(d,g)},error:function(d){e.log.error(d,g)},fatal:function(d){e.log.fatal(d,g)}};return{subscribe:function(d,h){e.subscribe(g,d,h)},unsubscribe:function(d){e.unsubscribe(g,d)},publish:i,startSubModule:function(d,h,l){e.startSubModule(d,h,l,g)},stopSubModule:function(d){e.stop(d)},getModel:function(d){return e.getModel(g,
d)},getView:function(d){return e.getView(g,d)},debug:j.debug,info:j.info,warn:j.warn,error:j.error,fatal:j.fatal,_:function(d){return e.i18n._(g,d)},hotkeys:function(d,h,l,o){if(typeof h==="string"){o||(o="keypress");$(document).bind(o,d,function(){i(h,l)})}else if(typeof h==="function"){l||(l="keypress");$(document).bind(l,d,h)}}}};return function(){var e={},g={},i={},j={},d={},h={},l=function(a){if(typeof a!=="object"){e.log.error("could not register module - option has to be an object","core");
return false}if(a.views){if(typeof a.views!=="object"){e.log.error("could not register module - 'views' property has to be an object","core");return false}for(var b in a.views)if(a.views[b]){if(typeof a.views[b]!=="function"){e.log.error("could not register module - the view "+b+" is not a function","core");return false}if(typeof a.views[b](new q(e,"dummy"))!=="object"){e.log.error("could not register module - the view "+b+" does not return an object","core");return false}}}if(a.models){if(typeof a.models!==
"object"){e.log.error("could not register module - the 'models' property has to be an object","core");return false}for(var c in a.models)if(a.models[c]){b=a.models[c];if(typeof b!=="function"){e.log.error("could not register module - the model "+c+" is not a function","core");return false}if(typeof b(new q(e,"dummy"))!=="object"){e.log.error("could not register module - the model "+c+" does not return an object","core");return false}}}return true},o=function(a,b,c){if(typeof a!=="string"){e.log.error("could not register module- mouduleId has to be a string",
"core");return false}if(typeof b!=="function"){e.log.error("could not register module - creator has to be a constructor function","core");return false}a=b();if(typeof a!=="object"||typeof a.init!=="function"||typeof a.destroy!=="function"){e.log.error("could not register module - creator has to return an object with the functions 'init' and 'destroy'","core");return false}if(c)if(!l(c))return false;return true},u=function(a,b,c){if(typeof a==="string"&&(typeof b==="string"&&!c||typeof b==="object"&&
!c||typeof b==="string"&&typeof c==="object"||!b&&!c)){if(typeof b==="object"&&!c){c=b;b=a}if(!b&&!c){b=a;c={}}return{moduleId:a,instanceId:b,opt:c}}e.log.error("could not start module '"+a+"' - illegal arguments.","core")},s=function(a,b,c){if(a=u(a,b,c)){e.log.debug("start '"+a.moduleId+"'","core");b=a.instanceId;var f;var k=a.moduleId;c=a.instanceId;var n=g[k];if(n){f={};$.extend(true,f,n.opt,a.opt);k=new q(e,c,f);n=n.creator(k);n.opt=f;if(f.models){for(var m in f.models)if(f.models[m]){var p=
c,r=m,w=f.models[m](k);d[p]||(d[p]={});d[p][r]=w}delete f.models}if(f.views){for(var v in f.views)if(f.views){m=c;p=v;r=f.views[v](k);h[m]||(h[m]={});h[m][p]=r}delete f.views}f=n}else e.log.error("could not start module '"+k+"' - module does not exist.","core");i[b]=f;i[a.instanceId].init();return true}return false},t=function(a){var b=i[a];if(b){b.destroy();delete i[a];for(var c in j[a])j[a][c]&&t(j[a][c])}else e.log.error("could not stop instance '"+a+"' - instance does not exist.","core")};return e=
{register:function(a,b,c){if(!o(a,b,c))return false;c||(c={});g[a]={creator:b,opt:c};return true},start:s,startSubModule:function(a,b,c,f){a=u(a,b,c);if(s(a.moduleId,a.instanceId,a.opt)&&typeof f==="string"){(f=j[f])||(f=[]);f.push(a.instanceId)}},stop:t,startAll:function(){for(var a in g)g[a]&&s(a,a,g[a].opt)},stopAll:function(){for(var a in i)i.hasOwnProperty(a)&&t(a)},publish:function(a,b){for(var c in i)if(i[c].subscriptions){var f=i[c].subscriptions[a];if(f)for(var k in f)typeof f[k]==="function"&&
f[k](a,b)}},subscribe:function(a,b,c){e.log.debug("subscribe to '"+b+"'",a);a=i[a];if(!a.subscriptions)a.subscriptions={};a=a.subscriptions;a[b]||(a[b]=[]);a[b].push(c)},getModel:function(a,b){if(d[a])return d[a][b]},getView:function(a,b){if(h[a])return h[a][b]},getInstance:function(a){return i[a]},log:{debug:function(){},info:function(){},warn:function(){},error:function(){},fatal:function(){}}}}()}();
/* scaleApp.log.js */
scaleApp.log=function(){if(!console){console={};console.log=function(){};console.debug=function(){};console.info=function(){};console.warn=function(){};console.error=function(){};console.fatal=function(){}}var b={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},d=function(c,a,e){if(e)if(typeof a==="object"){d(c,e+":");d(c,a);return}else a=e+": "+a;switch(c){case b.DEBUG:0<=b.DEBUG&&console.debug(a);break;case b.INFO:0<=b.INFO&&console.info(a);break;case b.WARN:0<=b.WARN&&console.warn(a);break;case b.ERROR:0<=
b.ERROR&&console.error(a);break;case b.FATAL:0<=b.FATAL&&console.error(a);break;default:console.log(a)}};return{debug:function(c,a){d(b.DEBUG,c,a)},info:function(c,a){d(b.INFO,c,a)},warn:function(c,a){d(b.WARN,c,a)},error:function(c,a){d(b.ERROR,c,a)},fatal:function(c,a){d(b.FATAL,c,a)}}}();
/* scaleApp.i18n.js */
scaleApp.i18n=function(e){var d=function(){return navigator.language||navigator.browserLanguage},b=d();return{setLanguage:function(a){if(typeof a==="string"){b=a;this.publish("languageChanged",a);return true}return false},getBrowserLanguage:d,getLanguage:function(){return b},_:function(a,f){var c=e.getInstance(a);if(c.opt)if(c.opt.i18n)return c.opt.i18n[b][f];return""}}}(scaleApp);