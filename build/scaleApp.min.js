(function(i,c){function f(a){var b=k[a];if(b)b.destroy(),delete k[a],$.each(p[a],function(a,o){o&&f(o)});else return h("could not stop instance '"+a+"' - instance does not exist.",c),!1}function g(a,b,e,j){return typeof a==="string"&&(typeof b==="string"&&!e||typeof b==="object"&&!e||typeof b==="string"&&typeof e==="object"||!b&&!e)||$.isArray(a)&&!b&&!e?d(a,b,e,j):(h("could not start module '"+a+"' - illegal arguments.",c),!1)}function d(a,e,d,j){var f=b(a,e,d);if(f)return l("start '"+f.moduleId+
"'",c,"debug"),m(f.moduleId,f.instanceId,f.opt,function(a){k[f.instanceId]=a;a.init(a.opt);typeof j==="function"&&j()}),!0;return!1}function b(a,b,c){typeof b==="object"&&!c&&(c=b,b=a);!b&&!c&&(b=a,c={});return{moduleId:a,instanceId:b,opt:c}}function a(a,b,d){if(typeof a!=="string")return h("could not register module- mouduleId has to be a string",c),!1;if(typeof b!=="function")return h("could not register module - creator has to be a constructor function",c),!1;a=b();if(typeof a!=="object"||typeof a.init!==
"function"||typeof a.destroy!=="function")return h("could not register module - creator has to return an object with the functions 'init' and 'destroy'",c),!1;if(d&&!e(d))return!1;return!0}function e(a){if(typeof a!=="object")return h("could not register module - option has to be an object",c),!1;if(a.views&&typeof a.views!=="object")return!1;if(a.models&&typeof a.models!=="object")return!1;if(a.templates&&typeof a.templates!=="object")return!1;return!0}function m(a,b,e,d){function f(){typeof d===
"function"&&d(l)}var g=n[a],l;if(g){var h={};$.extend(!0,h,g.opt,e);var m=new j.sandbox(b,h);l=g.creator(m);l.opt=h;$.each(q,function(a,c){c(b,h,m)});h.templates&&j.template?j.template.loadMultiple(h.templates).done(function(a){j.template.set(b,a);f()}).fail(function(){}).then(function(){delete h.templates}):f()}else(void 0)("could not start module '"+a+"' - module does not exist.",c)}function h(a,b){l(a,b,"error")}function l(a,b,c){if(j.log&&typeof j.log[c]==="function")j.log[c](a,b)}var j=this,
n={},k={},p={},q=[],j={register:function(b,c,e){if(!a(b,c,e))return!1;e||(e={});n[b]={creator:c,opt:e};return!0},onInstantiate:function(a){typeof a==="function"?q.push(a):h("onInstantiate expect a function as parameter",c)},start:g,startSubModule:function(a,c,e,d,f){a=b(a,c,e);g(a.moduleId,a.instanceId,a.opt,f)&&typeof d==="string"&&((d=p[d])||(d=[]),d.push(a.instanceId))},stop:f,startAll:function(a,b){function e(){}if(typeof a==="function")var d=0,d=$.isArray(b)?b.length:j.util.countObjectKeys(n),
e=function(){d--;d===0&&a()};$.isArray(b)?$.each(b,function(a,b){typeof b==="string"?g(b,b,n[b].opt,e):typeof b==="object"?b.j&&b.k?g(b.j,b.m,b.k,e):h("Could not start module from array - invalid parameters",c):h("Could not start module from array",c)}):$.each(n,function(a,b){b&&g(a,a,b.opt,e)})},stopAll:function(){$.each(k,function(a){f(a)})},publish:function(a,b,c){$.each(k,function(e,d){if(d.subscriptions){var f=d.subscriptions[a];f&&$.each(f,function(e,d){if(typeof d==="function")if(typeof b===
"object"&&c!==!0){var f={};$.extend(!0,f,b);d(f,a)}else d(b,a)})}})},subscribe:function(a,b,c){l("subscribe to '"+b+"'",a,"debug");a=k[a];a.subscriptions||(a.subscriptions={});a=a.subscriptions;a[b]||(a[b]=[]);a[b].push(c)},getContainer:function(a){var b=k[a].opt;if(b&&typeof b.container==="string")return $("#"+b.container);return $("#"+a)},getInstance:function(a){return k[a]},log:l};i[c]=i[c]||j})(window,"scaleApp");(function(i,c,f){function g(a,e,f){if(f)if(typeof e==="object"){g(a,f+":");g(a,e);return}else e=f+": "+e;switch(a){case b.d:d<=b.d&&c.debug(e);break;case b.c:d<=b.c&&c.info(e);break;case b.g:d<=b.g&&c.warn(e);break;case b.f:d<=b.f&&c.error(e);break;case b.e:d<=b.e&&c.error(e);break;default:c.log(e)}}c||(i=function(){},c={log:i,debug:i,info:i,warn:i,error:i,fatal:i});var d=0,b={d:0,c:1,g:2,f:3,e:4};f.log={debug:function(a,c){g(b.d,a,c)},info:function(a,c){g(b.c,a,c)},warn:function(a,c){g(b.g,a,c)},
error:function(a,c){g(b.f,a,c)},fatal:function(a,c){g(b.e,a,c)},setLogLevel:function(a){if(typeof a==="string")switch(a.toLowerCase()){case "debug":d=b.d;break;case "info":d=b.c;break;case "warn":d=b.g;break;case "error":d=b.f;break;case "fatal":d=b.e;break;default:d=b.c}else typeof a==="number"&&(d=a>=b.d&&a<=b.e?a:b.c)},getLogLevel:function(){return d}}})(window,window.console,window.scaleApp);(function(i,c){function f(){return(navigator.language||navigator.l||"en").split("-")[0]}var g=f();c.i18n=c.i18n||{setLanguage:function(d){if(typeof d==="string")return g=d,c.publish("languageChanged",d),!0;return!1},getBrowserLanguage:f,getLanguage:function(){return g},_:function(d,b){var a=c.getInstance(d);if(a.opt&&a.opt.i18n)if(a=a.opt.i18n,a[g]&&a[g][b])return a[g][b];else{var e=g.substring(0,2);if(a[e]&&a[e][b])return a[e][b];else if(a.en&&a.en[b])return a.en[b]}return b}}})(window,window.scaleApp);(function(i,c){c.util=c.util||{mixin:function(c,g){function d(b,a){var c={};$.extend(c,b,a);$.extend(a,c)}switch(typeof g+"-"+typeof c){case "function-function":d(g.prototype,c.prototype);break;case "function-object":d(g.prototype,c);break;case "object-object":d(g,c);break;case "object-function":d(g,c.prototype)}},countObjectKeys:function(c){var g=0;if(typeof c==="object")for(var d in c)g++;return g}}})(window,window.scaleApp);(function(i,c){function f(c){var b=$.Deferred();typeof c==="string"?$.get(c).done(function(a){b.resolve($('<script type="text/x-jquery-tmpl">'+a+"<\/script>").template())}).fail(function(){b.reject("Could not load the template")}):b.reject("function argument has to be a string");return b.promise()}var g={};c.template=c.template||{load:f,loadMultiple:function(c){function b(a){return function(b){g[a]=b}}var a=$.Deferred(),e=[],g={},h;for(h in c)e.push(f(c[h]).done(new b(h)));$.when.apply(null,e).done(function(){a.resolve(g)});
return a.promise()},get:function(c,b){var a=g[c];if(a){if(!b&&$(a).length===1){for(var e in a)break;return a[e]}return a[b]}},add:function(d,b,a){typeof d==="string"&&typeof b==="string"&&typeof a==="function"?(g[d]||(g[d]={}),g[d][b]=a):c.log.error("could not add template: invalid parameters","template")},set:function(d,b){typeof d==="string"&&typeof b==="object"?g[d]=b:c.log.error("could not set templates: invalid parameters","template")}}})(window,window.scaleApp);(function(i,c){function f(a,b,e){if(a=a[b]){if(!e&&c.util.countObjectKeys(a)===1){for(var d in a)break;return a[d]}return a[e]}}function g(a,b,c,e){a[b]||(a[b]={});a[b][c]=e}function d(a,b,c){typeof c==="object"&&$.each(c,function(c,e){e&&g(a,b,c,e)})}function b(b){typeof b==="object"&&$.each(b,function(b,e){e&&c.util.mixin(e,a)})}function a(){}a.prototype={subscribe:function(a){if(!this.b)this.b=[];this.b.push(a)},unsubscribe:function(a){if(this.b)this.b=this.b.filter(function(b){if(b!==a)return b})},
notify:function(){this.b&&$.each(this.b,function(a,b){typeof b.update==="function"&&b.update()})}};var e={},m={},h={};c.onInstantiate(function(a,c){c.models&&(b(c.models),d(e,a,c.models));c.views&&d(m,a,c.views);c.controllers&&d(h,a,c.controllers)});c.a=c.a||{addModel:function(a,b,c){g(e,a,b,c)},addView:function(a,b,c){g(m,a,b,c)},addController:function(a,b,c){g(h,a,b,c)},getModel:function(a,b){return f(e,a,b)},getView:function(a,b){return f(m,a,b)},getController:function(a,b){return f(h,a,b)},observable:a}})(window,
window.scaleApp);(function(i,c){c.sandbox=c.sandbox||function(f){function g(a){return c.template.get(f,a)}function d(a,b,d){c.publish(a,b,d)}var b={h:function(a){c.log.debug(a,f)},info:function(a){c.log.info(a,f)},warn:function(a){c.log.warn(a,f)},error:function(a){c.log.error(a,f)},i:function(a){c.log.fatal(a,f)}};return{subscribe:function(a,b){c.subscribe(f,a,b)},unsubscribe:function(a){c.unsubscribe(f,a)},publish:d,startSubModule:function(a,b,d,g){c.startSubModule(a,b,d,f,g)},stopSubModule:function(a){c.stop(a)},
getModel:function(a){return c.a.getModel(f,a)},getView:function(a){return c.a.getView(f,a)},getController:function(a){return c.a.getController(f,a)},addModel:function(a,b){return c.a.addModel(f,a,b)},addView:function(a,b){return c.a.addView(f,a,b)},addController:function(a,b){return c.a.addController(f,a,b)},observable:c.a.observable,getTemplate:g,tmpl:function(a,c){if(typeof a==="string")return $.tmpl(g(a),c);else if(typeof a==="function")return $.tmpl(a,c);else b.error("type of 'id' is not valid",
"sandbox of "+f)},getContainer:function(){return c.getContainer(f)},debug:b.h,info:b.info,warn:b.warn,error:b.error,fatal:b.i,mixin:c.util.mixin,count:c.util.countObjectKeys,_:function(a){return c.i18n._(f,a)},getLanguage:c.i18n.getLanguage,hotkeys:function(a,b,c,f){typeof b==="string"?(f||(f="keypress"),$(document).bind(f,a,function(){d(b,c)})):typeof b==="function"&&(c||(c="keypress"),$(document).bind(c,a,b))}}}})(window,window.scaleApp);
