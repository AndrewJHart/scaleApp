/* scaleApp.js */
var scaleApp=function(){return function(){var e={},j={},f={},n={},k={},l={},t=function(a){if(typeof a!=="object"){e.log.error("could not register module - option has to be an object","core");return false}if(a.views){if(typeof a.views!=="object"){e.log.error("could not register module - 'views' property has to be an object","core");return false}for(var b in a.views)if(a.views[b]){if(typeof a.views[b]!=="function"){e.log.error("could not register module - the view "+b+" is not a function","core");return false}if(typeof a.views[b](new e.sandbox(e,
"dummy"))!=="object"){e.log.error("could not register module - the view "+b+" does not return an object","core");return false}}}if(a.models){if(typeof a.models!=="object"){e.log.error("could not register module - the 'models' property has to be an object","core");return false}for(var c in a.models)if(a.models[c]){b=a.models[c];if(typeof b!=="function"){e.log.error("could not register module - the model "+c+" is not a function","core");return false}if(typeof b(new e.sandbox(e,"dummy"))!=="object"){e.log.error("could not register module - the model "+
c+" does not return an object","core");return false}}}return true},u=function(a,b,c){if(typeof a!=="string"){e.log.error("could not register module- mouduleId has to be a string","core");return false}if(typeof b!=="function"){e.log.error("could not register module - creator has to be a constructor function","core");return false}a=b();if(typeof a!=="object"||typeof a.init!=="function"||typeof a.destroy!=="function"){e.log.error("could not register module - creator has to return an object with the functions 'init' and 'destroy'",
"core");return false}if(c)if(!t(c))return false;return true},r=function(a,b,c){if(typeof a==="string"&&(typeof b==="string"&&!c||typeof b==="object"&&!c||typeof b==="string"&&typeof c==="object"||!b&&!c)){if(typeof b==="object"&&!c){c=b;b=a}if(!b&&!c){b=a;c={}}return{moduleId:a,instanceId:b,opt:c}}e.log.error("could not start module '"+a+"' - illegal arguments.","core")},p=function(a,b,c){if(a=r(a,b,c)){e.log.debug("start '"+a.moduleId+"'","core");b=a.instanceId;var d;var g=a.moduleId;c=a.instanceId;
var i=j[g];if(i){d={};$.extend(true,d,i.opt,a.opt);g=new e.sandbox(e,c,d);i=i.creator(g);i.opt=d;if(d.models){for(var h in d.models)if(d.models[h]){var m=c,o=h,v=d.models[h]();k[m]||(k[m]={});k[m][o]=v}delete d.models}if(d.views){for(var s in d.views)if(d.views){h=c;m=s;o=d.views[s](g);l[h]||(l[h]={});l[h][m]=o}delete d.views}d=i}else e.log.error("could not start module '"+g+"' - module does not exist.","core");f[b]=d;f[a.instanceId].init();return true}return false},q=function(a){var b=f[a];if(b){b.destroy();
delete f[a];for(var c in n[a])n[a][c]&&q(n[a][c])}else e.log.error("could not stop instance '"+a+"' - instance does not exist.","core")};return e={register:function(a,b,c){if(!u(a,b,c))return false;c||(c={});j[a]={creator:b,opt:c};return true},start:p,startSubModule:function(a,b,c,d){a=r(a,b,c);if(p(a.moduleId,a.instanceId,a.opt)&&typeof d==="string"){(d=n[d])||(d=[]);d.push(a.instanceId)}},stop:q,startAll:function(){for(var a in j)j[a]&&p(a,a,j[a].opt)},stopAll:function(){for(var a in f)f.hasOwnProperty(a)&&
q(a)},publish:function(a,b){for(var c in f)if(f[c].subscriptions){var d=f[c].subscriptions[a];if(d)for(var g in d)typeof d[g]==="function"&&d[g](a,b)}},subscribe:function(a,b,c){e.log.debug("subscribe to '"+b+"'",a);a=f[a];if(!a.subscriptions)a.subscriptions={};a=a.subscriptions;a[b]||(a[b]=[]);a[b].push(c)},getModel:function(a,b){if(k[a])return k[a][b]},getView:function(a,b){if(l[a])return l[a][b]},getInstance:function(a){return f[a]},log:{debug:function(){},info:function(){},warn:function(){},error:function(){},
fatal:function(){}}}}()}();
/* scaleApp.sandbox.js */
scaleApp.sandbox=function(b,c){var h=function(a,d){b.publish(a,d)},f={debug:function(a){b.log.debug(a,c)},info:function(a){b.log.info(a,c)},warn:function(a){b.log.warn(a,c)},error:function(a){b.log.error(a,c)},fatal:function(a){b.log.fatal(a,c)}};return{subscribe:function(a,d){b.subscribe(c,a,d)},unsubscribe:function(a){b.unsubscribe(c,a)},publish:h,startSubModule:function(a,d,e){b.startSubModule(a,d,e,c)},stopSubModule:function(a){b.stop(a)},getModel:function(a){return b.getModel(c,a)},getView:function(a){return b.getView(c,
a)},debug:f.debug,info:f.info,warn:f.warn,error:f.error,fatal:f.fatal,_:function(a){return b.i18n._(c,a)},hotkeys:function(a,d,e,g){if(typeof d==="string"){g||(g="keypress");$(document).bind(g,a,function(){h(d,e)})}else if(typeof d==="function"){e||(e="keypress");$(document).bind(e,a,d)}}}};
/* scaleApp.log.js */
scaleApp.log=function(){if(!console){console={};console.log=function(){};console.debug=function(){};console.info=function(){};console.warn=function(){};console.error=function(){};console.fatal=function(){}}var b={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},d=function(c,a,e){if(e)if(typeof a==="object"){d(c,e+":");d(c,a);return}else a=e+": "+a;switch(c){case b.DEBUG:0<=b.DEBUG&&console.debug(a);break;case b.INFO:0<=b.INFO&&console.info(a);break;case b.WARN:0<=b.WARN&&console.warn(a);break;case b.ERROR:0<=
b.ERROR&&console.error(a);break;case b.FATAL:0<=b.FATAL&&console.error(a);break;default:console.log(a)}};return{debug:function(c,a){d(b.DEBUG,c,a)},info:function(c,a){d(b.INFO,c,a)},warn:function(c,a){d(b.WARN,c,a)},error:function(c,a){d(b.ERROR,c,a)},fatal:function(c,a){d(b.FATAL,c,a)}}}();
/* scaleApp.i18n.js */
scaleApp.i18n=function(e){var d=function(){return(navigator.language||navigator.browserLanguage||"en").split("-")[0]},b=d();return{setLanguage:function(a){if(typeof a==="string"){b=a;this.publish("languageChanged",a);return true}return false},getBrowserLanguage:d,getLanguage:function(){return b},_:function(a,f){var c=e.getInstance(a);if(c.opt)if(c.opt.i18n)return c.opt.i18n[b][f];return""}}}(scaleApp);